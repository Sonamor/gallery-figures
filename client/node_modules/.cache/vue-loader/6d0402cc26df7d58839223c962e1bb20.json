{"remainingRequest":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\src\\components\\Picture.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\src\\components\\Picture.vue","mtime":1586192791774},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBGaWxlVXBsb2FkIGZyb20gJy4vRmlsZVVwbG9hZC52dWUnOwppbXBvcnQgYXV0aEhlYWRlciBmcm9tICcuLi9zZXJ2aWNlcy9hdXRoSGVhZGVyJzsKaW1wb3J0IEFsZXJ0cyBmcm9tICdAL2NvbXBvbmVudHMvQWxlcnRzLnZ1ZSc7CmltcG9ydCBidXMgZnJvbSAnLi4vLi4vYnVzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUGljdHVyZScsCiAgY29tcG9uZW50czogewogICAgRmlsZVVwbG9hZCwgQWxlcnRzLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBpY3R1cmVzOiBbXSwKICAgICAgcGljdHVyZTogewogICAgICAgIGlkOiAnJywgdGl0bGU6ICcnLCBmaWxlbmFtZTogJycsIGluZm9ybWF0aW9uOiAnJywKICAgICAgfSwKICAgICAgbW9kZTogJ2FkZCcsCiAgICAgIHBpY19maWxlbmFtZTogJycsCiAgICAgIHBpY190aXRsZTogJycsCiAgICAgIHBpY19pbmZvcm1hdGlvbjogJycsCiAgICAgIHBpY19zaXplOiAnc21hbGwnLAogICAgICBhbGVydHM6IFtdLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBsb2dnZWRJbigpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmF1dGguc3RhdHVzLmxvZ2dlZEluOwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICAkcm91dGUoKSB7CiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOwogICAgICBzZWxmLmZldGNoUGljdHVyZXMoKTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5zZXRNb2RlKCk7CiAgICBpZiAodGhpcy5tb2RlICE9PSAnYWRkJykgeyB0aGlzLmZldGNoUGljdHVyZXMoKTsgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8gRGlzcGxheSBwaWN0dXJlcyBmcm9tIHRoZSB1cGxvYWQgZGlyZWN0b3J5CiAgICBwaWN0dXJlVXJsKGZpbGVuYW1lKSB7CiAgICAgIGlmIChmaWxlbmFtZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBpbWFnZXMgPSByZXF1aXJlLmNvbnRleHQoJy4uLy4uLy4uL3NlcnZlci91cGxvYWRzLycsIGZhbHNlLCAvXC5qcGd8LnBuZ3wuanBlZyQvKTsKICAgICAgICAgIHJldHVybiBpbWFnZXMoYC4vJHtmaWxlbmFtZX1gKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnTW9kdWxlTm90Rm91bmRFcnJvcicpIHRocm93IGU7IC8vIGhhbmRsZSBmYWxzZS1wb3NpdGl2ZXMKICAgICAgICAgIHJldHVybiByZXF1aXJlKCcuLi9hc3NldHMvbG9nby5wbmcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlcXVpcmUoJy4uL2Fzc2V0cy9sb2dvLnBuZycpOwogICAgfSwKCiAgICAvLyBOYXZpZ2F0ZSB0byB0aGUgZ2FsbGVyeQogICAgY2xvc2VMaWdodGJveCgpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9nYWxsZXJ5Jyk7CiAgICB9LAoKICAgIC8vIE5hdmlnYXRlIHRvIHRoZSBzYW1lIGxheW91dCBidXQgaW4gZWRpdCBtb2RlCiAgICBlZGl0UGljdHVyZShjdXJyZW50UGljdHVyZUlkKSB7CiAgICAgIHRoaXMubW9kZSA9ICdlZGl0JzsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goYC9waWN0dXJlLyR7Y3VycmVudFBpY3R1cmVJZH0jZWRpdGApOwogICAgfSwKCiAgICAvLyBOYXZpZ2F0ZSB0byBuZXh0IG9yIHByZXZpb3VzIHBpY3R1cmUKICAgIHNob3dQaWN0dXJlKGN1cnJlbnRQaWN0dXJlSWQsIGluY3JlbWVudCkgewogICAgICBjdXJyZW50UGljdHVyZUlkID0gTnVtYmVyKGN1cnJlbnRQaWN0dXJlSWQpOwoKICAgICAgY29uc3QgbWF4UGljdHVyZUlkID0gdGhpcy5waWN0dXJlc1t0aGlzLnBpY3R1cmVzLmxlbmd0aCAtIDFdLmlkOwogICAgICBjb25zdCBtaW5QaWN0dXJlSWQgPSB0aGlzLnBpY3R1cmVzWzBdLmlkOwoKICAgICAgbGV0IG5leHRQaWN0dXJlSWQgPSAwOwoKICAgICAgLy8gSWYgYSBwaWN0dXJlIGlzIG1pc3NpbmcgKGVnIDogaGFzIGJlZW4gZGVsZXRlZCBjb21wbGV0ZWx5IGluIGRiKSBvciBpcyBkaXNhYmxlZCBhbmQgdXNlciBpcyBub3QgbG9nZ2VkIGluLCBza2lwIHRvIHRoZSBuKzEvLTEgbmV4dCBwaWN0dXJlCiAgICAgIGlmIChjdXJyZW50UGljdHVyZUlkIDwgbWluUGljdHVyZUlkKSB7CiAgICAgICAgbmV4dFBpY3R1cmVJZCA9IG1heFBpY3R1cmVJZDsKICAgICAgfSBlbHNlIGlmIChjdXJyZW50UGljdHVyZUlkID4gbWF4UGljdHVyZUlkKSB7CiAgICAgICAgbmV4dFBpY3R1cmVJZCA9IG1pblBpY3R1cmVJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBuZXh0UGljID0gdGhpcy5waWN0dXJlcy5maW5kKHBpY3R1cmUgPT4gcGljdHVyZS5pZCA9PT0gTnVtYmVyKGN1cnJlbnRQaWN0dXJlSWQgKyBpbmNyZW1lbnQpKTsKCiAgICAgICAgaWYgKHR5cGVvZiBuZXh0UGljID09PSAndW5kZWZpbmVkJyB8fCAodHlwZW9mIG5leHRQaWMgIT09ICd1bmRlZmluZWQnICYmICF0aGlzLmxvZ2dlZEluICYmIG5leHRQaWMuYWN0aXZlID09PSBmYWxzZSkpIHsKICAgICAgICAgIHRoaXMuc2hvd1BpY3R1cmUoY3VycmVudFBpY3R1cmVJZCArIGluY3JlbWVudCwgaW5jcmVtZW50KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgbmV4dFBpY3R1cmVJZCA9IG5leHRQaWMuaWQ7CiAgICAgIH0KCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKGAvcGljdHVyZS8ke25leHRQaWN0dXJlSWR9YCk7CiAgICB9LAoKICAgIC8vIFNldCB0aGUgbW9kZSBvZiB0aGUgbGF5b3V0CiAgICBzZXRNb2RlKCkgewogICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmlkID09PSAnYWRkJykgewogICAgICAgIHRoaXMubW9kZSA9ICdhZGQnOwogICAgICB9IGVsc2UgaWYgKHRoaXMuJHJvdXRlLmhhc2ggPT09ICcjZWRpdCcpIHsKICAgICAgICB0aGlzLm1vZGUgPSAnZWRpdCc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tb2RlID0gJ3Nob3cnOwogICAgICB9CiAgICB9LAoKICAgIC8vIEZldGNoIHBpY3R1cmVzIGZyb20gdGhlIGRhdGFiYXNlCiAgICBmZXRjaFBpY3R1cmVzKCkgewogICAgICBjb25zdCBvcHRpb25zID0gKCF0aGlzLmxvZ2dlZEluKSA/IHsgYWN0aXZlOiB0cnVlIH0gOiB7fTsKICAgICAgYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3BpY3R1cmVzJywgewogICAgICAgIHBhcmFtczogb3B0aW9ucywKICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLnBpY3R1cmVzID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgdGhpcy5waWN0dXJlID0gdGhpcy5waWN0dXJlcy5maW5kKHBpY3R1cmUgPT4gKHRoaXMubG9nZ2VkSW4gJiYgcGljdHVyZS5pZCA9PT0gTnVtYmVyKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkpCiAgICAgICAgICB8fCAoIXRoaXMubG9nZ2VkSW4gJiYgcGljdHVyZS5hY3RpdmUgPT09IHRydWUgJiYgcGljdHVyZS5pZCA9PT0gTnVtYmVyKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkpKTsKCiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnBpY3R1cmUgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICB0aGlzLnBpY19maWxlbmFtZSA9IHRoaXMucGljdHVyZS5maWxlbmFtZTsKICAgICAgICAgIHRoaXMucGljX3RpdGxlID0gdGhpcy5waWN0dXJlLnRpdGxlOwogICAgICAgICAgdGhpcy5waWNfaW5mb3JtYXRpb24gPSB0aGlzLnBpY3R1cmUuaW5mb3JtYXRpb247CiAgICAgICAgICB0aGlzLnBpY19zaXplID0gdGhpcy5waWN0dXJlLnNpemU7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgIT09ICdhZGQnKSB7CiAgICAgICAgICAvLyBEaXNwbGF5IDQwNAogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMucGljdHVyZSAhPT0gJ3VuZGVmaW5lZCcgJiYgIXRoaXMubG9nZ2VkSW4gJiYgdGhpcy5waWN0dXJlLmFjdGl2ZSA9PT0gZmFsc2UpIHsKICAgICAgICAgIHRoaXMuc2hvd1BpY3R1cmUodGhpcy5waWN0dXJlLmlkICsgMSwgMSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgLy8gZGlzcGxheSB0aGUgdXBsb2FkZWQgZmlsZQogICAgZ2V0VXBsb2FkZWRGaWxlKHZhbHVlKSB7CiAgICAgIHRoaXMucGljX2ZpbGVuYW1lID0gdmFsdWU7CiAgICAgIHRoaXMub25TdWJtaXQoKTsKICAgIH0sCgogICAgaW5pdFN1Ym1pdCgpIHsKICAgICAgYnVzLiRlbWl0KCdmaWxlVXBsb2FkU3VibWl0Jyk7CiAgICB9LAoKICAgIC8vIEFkZCBvciBlZGl0IGEgcGljdHVyZQogICAgYXN5bmMgb25TdWJtaXQoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgYXhpb3MucG9zdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9waWN0dXJlcycsIHsKICAgICAgICAgIGlkOiAodGhpcy5tb2RlID09PSAnZWRpdCcgPyB0aGlzLnBpY3R1cmUuaWQgOiBudWxsKSwgdGl0bGU6IHRoaXMucGljX3RpdGxlLCBmaWxlbmFtZTogdGhpcy5waWNfZmlsZW5hbWUsIGluZm9ybWF0aW9uOiB0aGlzLnBpY19pbmZvcm1hdGlvbiwgc2l6ZTogdGhpcy5waWNfc2l6ZSwgbW9kZTogdGhpcy5tb2RlLAogICAgICAgIH0sIHsgaGVhZGVyczogYXV0aEhlYWRlcigpIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9nYWxsZXJ5Jyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmFsZXJ0cy5wdXNoKHsgbWVzc2FnZTogcmVzcG9uc2UubWVzc2FnZSwgaGFzRXJyb3I6IHRydWUgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuYWxlcnRzLnB1c2goeyBtZXNzYWdlOiBlcnIucmVzcG9uc2UuZGF0YS5tZXNzYWdlLCBoYXNFcnJvcjogdHJ1ZSB9KTsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Picture.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Picture.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"lightbox fixed w-screen h-screen xl:p-16 xl:px-48 lg:p-10 lg:px-24 md:p-6 md:px-20 p-4 px-16 top-0 left-0\" @mousedown.self=\"closeLightbox\">\n    <Alerts :alerts=\"alerts\"/>\n    <div class=\"lb-container w-full h-full flex lg:flex-row flex-col justify-center\">\n      <div class=\"overflow-x-auto flex-1 flex-grow max-w-full max-h-full bg-white rounded relative text-center relative\" v-if=\"(typeof this.picture === 'undefined')\">\n        <div class=\"absolute top30 w-full\">\n          <span class=\"w-full text-6xl text-blue-500 font-bold inline-block\">404</span>\n          <span class=\"w-full inline-block\">Oups ! L'image recherchée est introuvable</span>\n          <span class=\"w-full inline-block text-xs\">Elle a surement été volée par un Blood Raven...</span>\n        </div>\n      </div>\n      <div class=\"overflow-x-auto flex-1 flex-grow max-w-full max-h-full bg-white rounded-l relative\" v-if=\"(typeof this.picture !== 'undefined')\">\n        <div class=\"bg-white\" v-if=\"['edit', 'add'].includes(mode)\">\n          <FileUpload @uploadedFile=\"getUploadedFile\" ref=\"fileUpload\"/>\n        </div>\n        <div class=\"overflow-hidden bg-gray-300 bg-contain bg-no-repeat lb-picture w-full\" v-if=\"['edit', 'show'].includes(mode)\" v-bind:style=\"{ height: (mode === 'edit' ? '82%' : '100%'), backgroundImage: 'url(' + (picture ? pictureUrl(picture.filename) : '') + ')' }\">\n          <div class=\"w-full font-bold m-1 text-gray-900 mx-2\" v-if=\"mode === 'edit'\">Image remplacée</div>\n        </div>\n      </div>\n      <div v-bind:class=\"['lb-information flex-1 xl:max-w-md lg:max-w-xs w-full border border-solid border-gray-300 text-center p-4 overflow-auto rounded-r relative', (picture.active === false ? 'bg-red-300': 'bg-white')]\" v-if=\"(typeof this.picture !== 'undefined')\">\n        <button class=\"py-1 px-2 text-xs absolute top-0 right-0 hover:text-blue-700\" v-if=\"loggedIn && mode === 'show' && picture\" @click=\"editPicture(picture.id)\">\n          Modifier\n        </button>\n        <span class=\"lightbox-title font-bold text-4xl\" v-if=\"mode === 'show' && picture && picture.title\">{{ picture.title }}</span>\n        <p class=\"mt-4\" v-if=\"picture && picture.information && mode === 'show'\" v-html=\"picture.information\"></p>\n        <form v-if=\"['edit', 'add'].includes(mode)\" class=\"relative min-h-full\" @submit.prevent=\"onSubmit\" ref=\"pictureForm\">\n          <input type=\"hidden\" v-model=\"pic_filename\">\n          <input type=\"text\" v-model=\"pic_title\" class=\"w-full font-bold text-4xl border-0 border-b border-gray-300\" placeholder=\"Saisir un titre\">\n          <textarea v-model=\"pic_information\" class=\"w-full mt-5 border-0 border-b border-gray-300\" placeholder=\"Saisir des informations\"></textarea>\n          <div class=\"text-left text-gray-500\">\n            <label for=\"pic-size\">Taille de la miniature</label>\n            <select id=\"pic-size\" v-model=\"pic_size\" class=\"border-0 border-b border-gray-300 ml-8\">\n              <option value=\"small\">Petite</option>\n              <option value=\"medium\">Moyenne</option>\n              <option value=\"large\">Grande</option>\n            </select>\n          </div>\n        </form>\n        <button class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline absolute bottom-0 right-0 m-2\" @click=\"initSubmit\">\n          Enregistrer\n        </button>\n      </div>\n    </div>\n    <div class=\"lb-chevron-left\" @click.self=\"showPicture(picture.id, -1)\" v-if=\"mode === 'show' && (typeof this.picture !== 'undefined')\"></div>\n    <div class=\"lb-chevron-right\" @click.self=\"showPicture(picture.id, 1)\" v-if=\"mode === 'show' && (typeof this.picture !== 'undefined')\"></div>\n    <div class=\"lb-cross\" @click.self=\"closeLightbox\"></div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport FileUpload from './FileUpload.vue';\nimport authHeader from '../services/authHeader';\nimport Alerts from '@/components/Alerts.vue';\nimport bus from '../../bus';\n\nexport default {\n  name: 'Picture',\n  components: {\n    FileUpload, Alerts,\n  },\n  data() {\n    return {\n      pictures: [],\n      picture: {\n        id: '', title: '', filename: '', information: '',\n      },\n      mode: 'add',\n      pic_filename: '',\n      pic_title: '',\n      pic_information: '',\n      pic_size: 'small',\n      alerts: [],\n    };\n  },\n  computed: {\n    loggedIn() {\n      return this.$store.state.auth.status.loggedIn;\n    },\n  },\n  watch: {\n    $route() {\n      const self = this;\n      self.fetchPictures();\n    },\n  },\n  created() {\n    this.setMode();\n    if (this.mode !== 'add') { this.fetchPictures(); }\n  },\n  methods: {\n    // Display pictures from the upload directory\n    pictureUrl(filename) {\n      if (filename) {\n        try {\n          const images = require.context('../../../server/uploads/', false, /\\.jpg|.png|.jpeg$/);\n          return images(`./${filename}`);\n        } catch (e) {\n          if (e.name !== 'ModuleNotFoundError') throw e; // handle false-positives\n          return require('../assets/logo.png');\n        }\n      }\n      return require('../assets/logo.png');\n    },\n\n    // Navigate to the gallery\n    closeLightbox() {\n      this.$router.push('/gallery');\n    },\n\n    // Navigate to the same layout but in edit mode\n    editPicture(currentPictureId) {\n      this.mode = 'edit';\n      this.$router.push(`/picture/${currentPictureId}#edit`);\n    },\n\n    // Navigate to next or previous picture\n    showPicture(currentPictureId, increment) {\n      currentPictureId = Number(currentPictureId);\n\n      const maxPictureId = this.pictures[this.pictures.length - 1].id;\n      const minPictureId = this.pictures[0].id;\n\n      let nextPictureId = 0;\n\n      // If a picture is missing (eg : has been deleted completely in db) or is disabled and user is not logged in, skip to the n+1/-1 next picture\n      if (currentPictureId < minPictureId) {\n        nextPictureId = maxPictureId;\n      } else if (currentPictureId > maxPictureId) {\n        nextPictureId = minPictureId;\n      } else {\n        const nextPic = this.pictures.find(picture => picture.id === Number(currentPictureId + increment));\n\n        if (typeof nextPic === 'undefined' || (typeof nextPic !== 'undefined' && !this.loggedIn && nextPic.active === false)) {\n          this.showPicture(currentPictureId + increment, increment);\n          return;\n        }\n        nextPictureId = nextPic.id;\n      }\n\n      this.$router.push(`/picture/${nextPictureId}`);\n    },\n\n    // Set the mode of the layout\n    setMode() {\n      if (this.$route.params.id === 'add') {\n        this.mode = 'add';\n      } else if (this.$route.hash === '#edit') {\n        this.mode = 'edit';\n      } else {\n        this.mode = 'show';\n      }\n    },\n\n    // Fetch pictures from the database\n    fetchPictures() {\n      const options = (!this.loggedIn) ? { active: true } : {};\n      axios.get('http://localhost:3000/api/pictures', {\n        params: options,\n      }).then((response) => {\n        this.pictures = response.data;\n\n        this.picture = this.pictures.find(picture => (this.loggedIn && picture.id === Number(this.$route.params.id))\n          || (!this.loggedIn && picture.active === true && picture.id === Number(this.$route.params.id)));\n\n        if (typeof this.picture !== 'undefined') {\n          this.pic_filename = this.picture.filename;\n          this.pic_title = this.picture.title;\n          this.pic_information = this.picture.information;\n          this.pic_size = this.picture.size;\n        } else if (this.mode !== 'add') {\n          // Display 404\n        } else if (typeof this.picture !== 'undefined' && !this.loggedIn && this.picture.active === false) {\n          this.showPicture(this.picture.id + 1, 1);\n        }\n      });\n    },\n\n    // display the uploaded file\n    getUploadedFile(value) {\n      this.pic_filename = value;\n      this.onSubmit();\n    },\n\n    initSubmit() {\n      bus.$emit('fileUploadSubmit');\n    },\n\n    // Add or edit a picture\n    async onSubmit() {\n      try {\n        await axios.post('http://localhost:3000/api/pictures', {\n          id: (this.mode === 'edit' ? this.picture.id : null), title: this.pic_title, filename: this.pic_filename, information: this.pic_information, size: this.pic_size, mode: this.mode,\n        }, { headers: authHeader() }).then((response) => {\n          if (response.status === 200) {\n            this.$router.push('/gallery');\n          } else {\n            this.alerts.push({ message: response.message, hasError: true });\n          }\n        });\n      } catch (err) {\n        this.alerts.push({ message: err.response.data.message, hasError: true });\n      }\n    },\n  },\n};\n</script>\n\n<style>\n  .lightbox {\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n\n  .lb-picture{\n    background-position: 50% 50%;\n  }\n\n  .lb-chevron-left{\n    position:fixed;\n    top: 50%;\n    left:15px;\n    height:32px;\n    width:32px;\n    background: url('../assets/icons/chevron-left.png');\n    cursor:pointer;\n  }\n\n  .lb-chevron-right{\n    position:fixed;\n    top: 50%;\n    right:15px;\n    height:32px;\n    width:32px;\n    background: url('../assets/icons/chevron-right.png');\n    cursor:pointer;\n  }\n\n  .lb-cross{\n    position:fixed;\n    top:15px;\n    right:15px;\n    height:32px;\n    width:32px;\n    background: url('../assets/icons/cross.png');\n    cursor:pointer;\n  }\n\n  textarea{\n    min-height:150px;\n  }\n\n  .top30{\n    top:30%;\n  }\n</style>\n"]}]}