{"remainingRequest":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\src\\components\\Picture.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\src\\components\\Picture.vue","mtime":1581899168826},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBteVVwbG9hZCBmcm9tICd2dWUtaW1hZ2UtY3JvcC11cGxvYWQnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQaWN0dXJlJywKICBjb21wb25lbnRzOiB7CiAgICAnbXktdXBsb2FkJzogbXlVcGxvYWQsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGljdHVyZXM6IFtdLAogICAgICBwaWN0dXJlOiB7CiAgICAgICAgaWQ6ICcnLCB0aXRsZTogJycsIGZpbGVuYW1lOiAnJywgaW5mb3JtYXRpb246ICcnLAogICAgICB9LAogICAgICBtb2RlOiAnYWRkJywKICAgICAgcGFyYW1zOiB7CiAgICAgICAgdG9rZW46ICcxMjM0NTY3OTgnLAogICAgICAgIG5hbWU6ICdhdmF0YXInLAogICAgICB9LAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgc21haWw6ICcqX34nLAogICAgICB9LAogICAgICBpbWdEYXRhVXJsOiAnJywKICAgICAgdXBsb2FkQm94U2hvdzogZmFsc2UsCiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgICRyb3V0ZSgpIHsKICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICAgIHNlbGYuZmV0Y2hQaWN0dXJlcygpOwogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnNldE1vZGUoKTsKICAgIHRoaXMuZmV0Y2hQaWN0dXJlcygpOwogIH0sCiAgbWV0aG9kczogewogICAgcGljdHVyZVVybChmaWxlbmFtZSkgewogICAgICBjb25zdCBpbWFnZXMgPSByZXF1aXJlLmNvbnRleHQoJy4uL2Fzc2V0cy8nLCBmYWxzZSwgL1wuanBnJC8pOwogICAgICByZXR1cm4gaW1hZ2VzKGAuLyR7ZmlsZW5hbWV9YCk7CiAgICB9LAogICAgY2xvc2VMaWdodGJveCgpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9GaWd1cmUnKTsKICAgIH0sCiAgICBzaG93UGljdHVyZShjdXJyZW50UGljSWQsIGluY3JlbWVudCkgewogICAgICBsZXQgbmV4dFBpY0lkID0gMDsKCiAgICAgIGlmICgoY3VycmVudFBpY0lkICsgaW5jcmVtZW50KSA8IDApIHsKICAgICAgICBuZXh0UGljSWQgPSB0aGlzLnBpY3R1cmVzLmxlbmd0aCAtIDE7CiAgICAgIH0gZWxzZSBpZiAoKGN1cnJlbnRQaWNJZCArIGluY3JlbWVudCkgPj0gdGhpcy5waWN0dXJlcy5sZW5ndGgpIHsKICAgICAgICBuZXh0UGljSWQgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIG5leHRQaWNJZCA9IGN1cnJlbnRQaWNJZCArIGluY3JlbWVudDsKICAgICAgfQoKICAgICAgdGhpcy4kcm91dGVyLnB1c2goYC9waWN0dXJlLyR7bmV4dFBpY0lkfWApOwogICAgfSwKICAgIHNldE1vZGUoKSB7CiAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09ICdhZGQnKSB7CiAgICAgICAgdGhpcy5tb2RlID0gJ2FkZCc7CiAgICAgIH0gZWxzZSBpZiAodGhpcy4kcm91dGUucXVlcnkuZWRpdCA9PT0gbnVsbCkgewogICAgICAgIHRoaXMubW9kZSA9ICdlZGl0JzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm1vZGUgPSAnc2hvdyc7CiAgICAgIH0KICAgIH0sCiAgICBmZXRjaFBpY3R1cmVzKCkgewogICAgICBheGlvcy5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcGljdHVyZXMnKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIHRoaXMucGljdHVyZXMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMucGljdHVyZSA9IHRoaXMucGljdHVyZXMuZmluZChwaWN0dXJlID0+IHBpY3R1cmUuaWQgPT09IE51bWJlcih0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpKTsKICAgICAgfSk7CiAgICB9LAogICAgZGlzcGxheVVwbG9hZEJveCgpIHsKICAgICAgdGhpcy51cGxvYWRCb3hTaG93ID0gIXRoaXMudXBsb2FkQm94U2hvdzsKICAgIH0sCiAgICAvKioKICAgICAgKiBjcm9wIHN1Y2Nlc3MKICAgICAgKgogICAgICAqIFtwYXJhbV0gaW1nRGF0YVVybAogICAgICAqIFtwYXJhbV0gZmllbGQKICAgICAgKi8KICAgIGNyb3BTdWNjZXNzKGltZ0RhdGFVcmwpIHsKICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tIGNyb3Agc3VjY2VzcyAtLS0tLS0tLScpOwogICAgICB0aGlzLmltZ0RhdGFVcmwgPSBpbWdEYXRhVXJsOwogICAgfSwKICAgIC8qKgogICAgICAqIHVwbG9hZCBzdWNjZXNzCiAgICAgICoKICAgICAgKiBbcGFyYW1dIGpzb25EYXRhICBzZXJ2ZXIgYXBpIHJldHVybiBkYXRhLCBhbHJlYWR5IGpzb24gZW5jb2RlCiAgICAgICogW3BhcmFtXSBmaWVsZAogICAgICAqLwogICAgY3JvcFVwbG9hZFN1Y2Nlc3MoanNvbkRhdGEsIGZpZWxkKSB7CiAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLSB1cGxvYWQgc3VjY2VzcyAtLS0tLS0tLScpOwogICAgICBjb25zb2xlLmxvZyhqc29uRGF0YSk7CiAgICAgIGNvbnNvbGUubG9nKGBmaWVsZDogJHtmaWVsZH1gKTsKICAgIH0sCiAgICAvKioKICAgICAgKiB1cGxvYWQgZmFpbAogICAgICAqCiAgICAgICogW3BhcmFtXSBzdGF0dXMgICAgc2VydmVyIGFwaSByZXR1cm4gZXJyb3Igc3RhdHVzLCBsaWtlIDUwMAogICAgICAqIFtwYXJhbV0gZmllbGQKICAgICAgKi8KICAgIGNyb3BVcGxvYWRGYWlsKHN0YXR1cywgZmllbGQpIHsKICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tIHVwbG9hZCBmYWlsIC0tLS0tLS0tJyk7CiAgICAgIGNvbnNvbGUubG9nKHN0YXR1cyk7CiAgICAgIGNvbnNvbGUubG9nKGBmaWVsZDogJHtmaWVsZH1gKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Picture.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Picture.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"lightbox fixed w-screen h-screen xl:p-16 xl:px-48 lg:p-10 lg:px-24 md:p-6 md:px-20 p-4 px-16 top-0 left-0\" @click.self=\"closeLightbox\">\n    <div class=\"lb-container w-full h-full flex lg:flex-row flex-col justify-center\">\n      <div class=\"overflow-hidden flex-1 flex-grow max-w-full max-h-full bg-gray-300 bg-contain bg-no-repeat lb-picture rounded-l\" v-if=\"['edit', 'show'].includes(mode)\" v-bind:style=\"{ backgroundImage: 'url(' + (picture ? pictureUrl(picture.filename) : '') + ')' }\">\n      </div>\n      <div class=\"overflow-hidden flex-1 flex-grow max-w-full max-h-full bg-white bg-contain bg-no-repeat rounded-l relative\" v-else-if=\"mode === 'add'\">\n        <div class=\"bg-white bg-contain bg-no-repeat addIcon\" @click=\"displayUploadBox\"></div>\n      </div>\n      <div class=\"lb-information bg-white flex-1 xl:max-w-md lg:max-w-xs w-full border border-solid border-gray-300 text-center p-4 overflow-auto rounded-r\">\n        <span class=\"lightbox-title font-bold text-4xl\" v-if=\"mode === 'show' && picture && picture.title\">{{ picture.title }}</span>\n        <p class=\"mt-4\" v-if=\"picture && picture.information && mode === 'show'\" v-html=\"picture.information\"></p>\n        <form v-if=\"['edit', 'add'].includes(mode)\" class=\"relative min-h-full\">\n          <input type=\"text\" class=\"w-full font-bold text-4xl border-0 border-b border-gray-300\" :placeholder=\"(picture ? picture.title : 'Saisir un titre')\">\n          <textarea class=\"w-full mt-5 border-0 border-b border-gray-300\" :placeholder=\"(picture ? picture.information : 'Saisir des informations')\"></textarea>\n          <button class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline absolute bottom-0 right-0\" type=\"button\">\n            Enregistrer\n          </button>\n        </form>\n      </div>\n    </div>\n    <div class=\"lb-chevron-left\" @click.self=\"showPicture(picture.id, -1)\" v-if=\"mode === 'show'\"></div>\n    <div class=\"lb-chevron-right\" @click.self=\"showPicture(picture.id, 1)\" v-if=\"mode === 'show'\"></div>\n    <div class=\"lb-cross\" @click.self=\"closeLightbox\"></div>\n        <my-upload field=\"img\"\n          @crop-success=\"cropSuccess\"\n          @crop-upload-success=\"cropUploadSuccess\"\n          @crop-upload-fail=\"cropUploadFail\"\n          v-model=\"uploadBoxShow\"\n          :width=\"774\"\n          :height=\"751\"\n          url=\"/upload\"\n          lang-type=\"fr\"\n          :params=\"params\"\n          :headers=\"headers\"\n          noCircle\n          noRotate\n          withCredentials\n          img-format=\"jpg\">\n        </my-upload>\n        <img :src=\"imgDataUrl\">\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport myUpload from 'vue-image-crop-upload';\n\nexport default {\n  name: 'Picture',\n  components: {\n    'my-upload': myUpload,\n  },\n  data() {\n    return {\n      pictures: [],\n      picture: {\n        id: '', title: '', filename: '', information: '',\n      },\n      mode: 'add',\n      params: {\n        token: '123456798',\n        name: 'avatar',\n      },\n      headers: {\n        smail: '*_~',\n      },\n      imgDataUrl: '',\n      uploadBoxShow: false,\n    };\n  },\n  watch: {\n    $route() {\n      const self = this;\n      self.fetchPictures();\n    },\n  },\n  created() {\n    this.setMode();\n    this.fetchPictures();\n  },\n  methods: {\n    pictureUrl(filename) {\n      const images = require.context('../assets/', false, /\\.jpg$/);\n      return images(`./${filename}`);\n    },\n    closeLightbox() {\n      this.$router.push('/Figure');\n    },\n    showPicture(currentPicId, increment) {\n      let nextPicId = 0;\n\n      if ((currentPicId + increment) < 0) {\n        nextPicId = this.pictures.length - 1;\n      } else if ((currentPicId + increment) >= this.pictures.length) {\n        nextPicId = 0;\n      } else {\n        nextPicId = currentPicId + increment;\n      }\n\n      this.$router.push(`/picture/${nextPicId}`);\n    },\n    setMode() {\n      if (this.$route.params.id === 'add') {\n        this.mode = 'add';\n      } else if (this.$route.query.edit === null) {\n        this.mode = 'edit';\n      } else {\n        this.mode = 'show';\n      }\n    },\n    fetchPictures() {\n      axios.get('http://localhost:3000/api/pictures').then((response) => {\n        this.pictures = response.data;\n        this.picture = this.pictures.find(picture => picture.id === Number(this.$route.params.id));\n      });\n    },\n    displayUploadBox() {\n      this.uploadBoxShow = !this.uploadBoxShow;\n    },\n    /**\n      * crop success\n      *\n      * [param] imgDataUrl\n      * [param] field\n      */\n    cropSuccess(imgDataUrl) {\n      console.log('-------- crop success --------');\n      this.imgDataUrl = imgDataUrl;\n    },\n    /**\n      * upload success\n      *\n      * [param] jsonData  server api return data, already json encode\n      * [param] field\n      */\n    cropUploadSuccess(jsonData, field) {\n      console.log('-------- upload success --------');\n      console.log(jsonData);\n      console.log(`field: ${field}`);\n    },\n    /**\n      * upload fail\n      *\n      * [param] status    server api return error status, like 500\n      * [param] field\n      */\n    cropUploadFail(status, field) {\n      console.log('-------- upload fail --------');\n      console.log(status);\n      console.log(`field: ${field}`);\n    },\n  },\n};\n</script>\n\n<style>\n  .lightbox {\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n\n  .lb-picture{\n    background-position: 50% 50%;\n  }\n\n  .lb-chevron-left{\n    position:fixed;\n    top: 50%;\n    left:15px;\n    height:32px;\n    width:32px;\n    background: url('../assets/icons/chevron-left.png');\n    cursor:pointer;\n  }\n\n  .lb-chevron-right{\n    position:fixed;\n    top: 50%;\n    right:15px;\n    height:32px;\n    width:32px;\n    background: url('../assets/icons/chevron-right.png');\n    cursor:pointer;\n  }\n\n  .lb-cross{\n    position:fixed;\n    top:15px;\n    right:15px;\n    height:32px;\n    width:32px;\n    background: url('../assets/icons/cross.png');\n    cursor:pointer;\n  }\n\n  .addIcon{\n    height:96px;\n    width:96px;\n    background: url('../assets/icons/xl-plus.png');\n    cursor:pointer;\n    margin: 0;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n\n  textarea{\n    min-height:150px;\n  }\n</style>\n"]}]}