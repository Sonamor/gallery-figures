{"remainingRequest":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\src\\components\\FileUpload.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\src\\components\\FileUpload.vue","mtime":1581975697235},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ayato\\Documents\\GitHub\\gallery-map-car\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0ZpbGVVcGxvYWQnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmaWxlOiAnJywKICAgICAgbWVzc2FnZTogJycsCiAgICAgIGhhc0Vycm9yOiBmYWxzZSwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBvblNlbGVjdCgpIHsKICAgICAgY29uc3QgYWxsb3dlZFR5cGVzID0gWydpbWFnZS9qcGVnJywgJ2ltYWdlL2pwZycsICdpbWFnZS9wbmcnXTsKICAgICAgY29uc3QgZmlsZSA9IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXTsKICAgICAgdGhpcy5maWxlID0gZmlsZTsKCiAgICAgIGlmICghYWxsb3dlZFR5cGVzLmluY2x1ZGVzKGZpbGUudHlwZSkpIHsKICAgICAgICB0aGlzLm1lc3NhZ2UgPSAnU2V1bGVzIGxlcyBpbWFnZXMgc29udCBhY2NlcHTDqWVzJzsKICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTsKICAgICAgfQogICAgICBpZiAoZmlsZS5zaXplID4gNTAwMDAwMCkgewogICAgICAgIHRoaXMubWVzc2FnZSA9ICdMXCdpbWFnZSBkw6lwYXNzZSA1MDAga2InOwogICAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgb25TdWJtaXQoKSB7CiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHRoaXMuZmlsZSk7CgogICAgICB0cnkgewogICAgICAgIGF3YWl0IGF4aW9zLnBvc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXBsb2FkJywgZm9ybURhdGEpOwogICAgICAgIHRoaXMubWVzc2FnZSA9ICdJbWFnZSBzYXV2ZWdhcmTDqWUnOwogICAgICAgIHRoaXMuJGVtaXQoJ3VwbG9hZGVkRmlsZScsIHRoaXMuZmlsZS5uYW1lKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyLnJlc3BvbnNlLmRhdGEuZXJyb3I7CiAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBnZXRDbGFzcygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAnYm9yZGVyIHB4LTQgcHktMyByb3VuZGVkIHJlbGF0aXZlIG10LTQnOiB0cnVlLAogICAgICAgICdiZy1yZWQtMTAwJzogdGhpcy5oYXNFcnJvciwKICAgICAgICAnYm9yZGVyLXJlZC00MDAnOiB0aGlzLmhhc0Vycm9yLAogICAgICAgICd0ZXh0LXJlZC03MDAnOiB0aGlzLmhhc0Vycm9yLAogICAgICAgICdiZy1ncmVlbi0xMDAnOiAhdGhpcy5oYXNFcnJvciwKICAgICAgICAnYm9yZGVyLWdyZWVuLTQwMCc6ICF0aGlzLmhhc0Vycm9yLAogICAgICAgICd0ZXh0LWdyZWVuLTcwMCc6ICF0aGlzLmhhc0Vycm9yLAogICAgICB9OwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["FileUpload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FileUpload.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"px-4 py-2\">\n    <form enctype=\"multipart/form-data\" @submit.prevent=\"onSubmit\">\n      <div class=\"fields\">\n          <div class=\"w-full font-bold\">Nouvelle image</div>\n          <input type=\"file\" ref=\"file\" @change=\"onSelect\" class=\"mt-2\">\n      </div>\n      <div class=\"fields\">\n        <button class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold px-2 rounded focus:outline-none focus:shadow-outline mt-4\">Valider</button>\n      </div>\n      <div v-bind:class=\"getClass()\" role=\"alert\" v-if=\"message != ''\">\n        <span class=\"block sm:inline\">{{ message }}</span>\n        <span class=\"absolute top-0 bottom-0 right-0 px-4 py-3\">\n          <svg @click=\"message = ''\" class=\"fill-current h-6 w-6\" role=\"button\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><title>Close</title><path d=\"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z\"/></svg>\n        </span>\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n  name: 'FileUpload',\n  data() {\n    return {\n      file: '',\n      message: '',\n      hasError: false,\n    };\n  },\n  methods: {\n    onSelect() {\n      const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png'];\n      const file = this.$refs.file.files[0];\n      this.file = file;\n\n      if (!allowedTypes.includes(file.type)) {\n        this.message = 'Seules les images sont acceptées';\n        this.hasError = true;\n      }\n      if (file.size > 5000000) {\n        this.message = 'L\\'image dépasse 500 kb';\n        this.hasError = true;\n      }\n    },\n    async onSubmit() {\n      const formData = new FormData();\n      formData.append('file', this.file);\n\n      try {\n        await axios.post('http://localhost:3000/api/upload', formData);\n        this.message = 'Image sauvegardée';\n        this.$emit('uploadedFile', this.file.name);\n      } catch (err) {\n        this.message = err.response.data.error;\n        this.hasError = true;\n      }\n    },\n    getClass() {\n      return {\n        'border px-4 py-3 rounded relative mt-4': true,\n        'bg-red-100': this.hasError,\n        'border-red-400': this.hasError,\n        'text-red-700': this.hasError,\n        'bg-green-100': !this.hasError,\n        'border-green-400': !this.hasError,\n        'text-green-700': !this.hasError,\n      };\n    },\n  },\n};\n</script>\n"]}]}